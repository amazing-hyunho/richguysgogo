<!doctype html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI íˆ¬ììœ„ì›íšŒ ë°ì´í„° ëŒ€ì‹œë³´ë“œ</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; margin: 0; background:#0f172a; color:#e2e8f0; }
    .container { max-width: 1200px; margin: 0 auto; padding: 24px; }
    h1 { margin: 0 0 20px 0; }
    .cards { display:grid; grid-template-columns:repeat(auto-fit,minmax(180px,1fr)); gap:12px; margin-bottom:20px; }
    .card { background:#1e293b; border-radius:12px; padding:14px; }
    .card .label { font-size:12px; color:#94a3b8; }
    .card .value { margin-top:6px; font-size:24px; font-weight:700; }
    .chart-grid { display:grid; grid-template-columns:1fr 1fr; gap:16px; }
    .panel { background:#1e293b; border-radius:12px; padding:14px; }
    .panel h2 { margin-top:0; font-size:16px; }
    table { width:100%; border-collapse:collapse; font-size:13px; }
    th, td { border-bottom:1px solid #334155; padding:8px 6px; text-align:left; vertical-align:top; }
    .full { margin-top:16px; }
    .badge { display:inline-block; margin-left:8px; font-size:12px; color:#93c5fd; }
    .agent-table td ul { margin:6px 0 0 16px; padding:0; }
    .agent-table td li { margin-bottom:2px; }
    .help-box { margin-top:10px; padding:10px 12px; border-radius:10px; background:#0b1220; border:1px solid #334155; font-size:12px; line-height:1.5; color:#cbd5e1; }
    .help-box strong { color:#e2e8f0; }
    @media (max-width: 900px) { .chart-grid { grid-template-columns:1fr; } }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ“Š AI íˆ¬ììœ„ì›íšŒ ëˆ„ì  ë°ì´í„° ëŒ€ì‹œë³´ë“œ</h1>
    <div class="cards" id="summary-cards"></div>

    <div class="chart-grid">
      <div class="panel">
        <h2>ì£¼ìš” ì§€ìˆ˜ ì¼ê°„ ë³€í™”ìœ¨ (%)</h2>
        <canvas id="marketChart"></canvas>
      </div>
      <div class="panel">
        <h2>ê±°ì‹œ ì§€í‘œ (VIX / USDKRW)</h2>
        <canvas id="macroChart"></canvas>
      </div>
      <div class="panel">
        <h2>ì™¸êµ­ì¸ ìˆœë§¤ìˆ˜ ì¶”ì´</h2>
        <canvas id="flowChart"></canvas>
      </div>
      <div class="panel">
        <h2>ìµœê·¼ ìš´ì˜ ê°€ì´ë˜ìŠ¤ (í…ìŠ¤íŠ¸)</h2>
        <table>
          <thead><tr><th>ë‚ ì§œ</th><th>ìœ ì§€(OK)</th><th>ì£¼ì˜(CAUTION)</th><th>íšŒí”¼(AVOID)</th></tr></thead>
          <tbody id="guidanceHistoryTable"></tbody>
        </table>
        <div class="help-box">
          <div><strong>ê°€ì´ë˜ìŠ¤ 3ë‹¨ê³„ ì˜ë¯¸</strong></div>
          <div>â€¢ <strong>ìœ ì§€(OK)</strong>: í˜„ì¬ ì „ëµ ìœ ì§€(ê¸°ì¡´ ë¹„ì¤‘ ì¤‘ì‹¬)</div>
          <div>â€¢ <strong>ì£¼ì˜(CAUTION)</strong>: ì‹ ê·œ ì§„ì…/ì¶”ê°€ ë§¤ìˆ˜ëŠ” ì‹ ì¤‘, ë¦¬ìŠ¤í¬ í•œë„ ê°•í™”</div>
          <div>â€¢ <strong>íšŒí”¼(AVOID)</strong>: í•´ë‹¹ í–‰ë™Â·ìì‚°ì€ ë‹¹ë¶„ê°„ í”¼í•˜ê¸°</div>
        </div>
      </div>
    </div>

    <div class="panel full">
      <h2>ìµœê·¼ ì˜ì¥ ì˜ê²¬ <span class="badge" id="chairDate"></span></h2>
      <div id="chairConsensus">-</div>
      <ul id="chairKeyPoints"></ul>
      <ul id="chairGuidance"></ul>
    </div>

    <div class="panel full">
      <h2>ìµœê·¼ íšŒì˜ í•©ì˜ ë‚´ì—­ (ê°€ì´ë˜ìŠ¤ ë‚´ìš©)</h2>
      <table>
        <thead><tr><th>ë‚ ì§œ</th><th>ì˜ì¥ í•©ì˜</th><th>ìœ ì§€(OK)</th><th>ì£¼ì˜(CAUTION)</th><th>íšŒí”¼(AVOID)</th></tr></thead>
        <tbody id="committeeTable"></tbody>
      </table>
    </div>

    <div class="panel full">
      <h2>ìµœê·¼ ì—ì´ì „íŠ¸ ì˜ê²¬ <span class="badge" id="stanceDate"></span></h2>
      <table class="agent-table">
        <thead><tr><th>ì—ì´ì „íŠ¸</th><th>êµ­ë©´ íƒœê·¸</th><th>ì‹ ë¢°ë„</th><th>ì˜ê²¬</th><th>í•µì‹¬ ì£¼ì¥</th></tr></thead>
        <tbody id="stanceTable"></tbody>
      </table>
    </div>
  </div>

<script>
const data = {"market_daily": [{"date": "2026-02-14", "kospi_pct": -0.27634023422029885, "kosdaq_pct": -1.768224793503113, "sp500_pct": 0.0499089148012519, "nasdaq_pct": -0.22339307336266215, "dow_pct": 0.09898333350053046}, {"date": "2026-02-23", "kospi_pct": 2.3123833749834866, "kosdaq_pct": -0.5780910962528827, "sp500_pct": 0.6939724763506775, "nasdaq_pct": 0.8964522328127177, "dow_pct": 0.4672696535852726}, {"date": "2026-02-24", "kospi_pct": 2.113383411321269, "kosdaq_pct": 1.1293509384554707, "sp500_pct": -1.0385652247284864, "nasdaq_pct": -1.1308222762413136, "dow_pct": -1.656209796912025}, {"date": "2026-02-25", "kospi_pct": 0.0, "kosdaq_pct": 0.0, "sp500_pct": 0.7651614086322255, "nasdaq_pct": 1.0448105947935815, "dow_pct": 0.7590381147059763}, {"date": "2026-02-26", "kospi_pct": 3.6721778816500654, "kosdaq_pct": 1.9652456051544733, "sp500_pct": 0.8136355657340022, "nasdaq_pct": 1.2613909684129887, "dow_pct": 0.6256259595928784}, {"date": "2026-02-27", "kospi_pct": -1.0010691871955486, "kosdaq_pct": 0.3896818404810278, "sp500_pct": -0.5365580569328385, "nasdaq_pct": -1.1821798206745227, "dow_pct": 0.03445844974079194}], "market_flow_daily": [{"date": "2026-02-14", "foreign_net": null, "foreign_20d": null, "foreign_60d": null}, {"date": "2026-02-23", "foreign_net": null, "foreign_20d": null, "foreign_60d": null}, {"date": "2026-02-24", "foreign_net": null, "foreign_20d": null, "foreign_60d": null}, {"date": "2026-02-25", "foreign_net": null, "foreign_20d": null, "foreign_60d": null}, {"date": "2026-02-26", "foreign_net": null, "foreign_20d": null, "foreign_60d": null}, {"date": "2026-02-27", "foreign_net": null, "foreign_20d": null, "foreign_60d": null}], "daily_macro": [{"date": "2026-02-14", "us10y": 4.056000232696533, "us2y": 3.5929999351501465, "spread_2_10": 0.4630002975463867, "vix": 20.600000381469727, "dxy": 96.88200378417969, "usdkrw": 1443.300048828125, "vix3m": 22.170000076293945, "vix_term_spread": 1.5699996948242188, "hy_oas": 2.95, "ig_oas": 0.79, "fed_balance_sheet": 6622382.0}, {"date": "2026-02-23", "us10y": 4.085999965667725, "us2y": 3.5950000286102295, "spread_2_10": 0.4909999370574951, "vix": 19.09000015258789, "dxy": 97.78900146484375, "usdkrw": 1444.68994140625, "vix3m": 22.139999389648438, "vix_term_spread": 1.1299991607666016, "hy_oas": 2.95, "ig_oas": 0.8, "fed_balance_sheet": 6613395.0}, {"date": "2026-02-24", "us10y": 4.0289998054504395, "us2y": 3.5880000591278076, "spread_2_10": 0.44099974632263184, "vix": 21.010000228881836, "dxy": 97.90299987792969, "usdkrw": 1445.52001953125, "vix3m": 21.34000015258789, "vix_term_spread": 1.7900009155273438, "hy_oas": 2.97, "ig_oas": 0.81, "fed_balance_sheet": 6613395.0}, {"date": "2026-02-25", "us10y": 4.0329999923706055, "us2y": 3.5880000591278076, "spread_2_10": 0.44499993324279785, "vix": 19.549999237060547, "dxy": 97.88200378417969, "usdkrw": 1441.47998046875, "vix3m": 20.360000610351562, "vix_term_spread": 2.4300003051757812, "hy_oas": 2.94, "ig_oas": 0.8, "fed_balance_sheet": 6613797.0}, {"date": "2026-02-26", "us10y": 4.047999858856201, "us2y": 3.5880000591278076, "spread_2_10": 0.45999979972839355, "vix": 17.93000030517578, "dxy": 97.62899780273438, "usdkrw": 1427.969970703125, "vix3m": 20.809999465942383, "vix_term_spread": 2.1800003051757812, "hy_oas": 2.94, "ig_oas": 0.8, "fed_balance_sheet": 6613797.0}, {"date": "2026-02-27", "us10y": 4.017000198364258, "us2y": 3.5880000591278076, "spread_2_10": 0.4290001392364502, "vix": 18.6299991607666, "dxy": 97.65599822998047, "usdkrw": 1438.7900390625, "vix3m": 20.809999465942383, "vix_term_spread": 2.1800003051757812, "hy_oas": 2.94, "ig_oas": 0.8, "fed_balance_sheet": 6613797.0}], "monthly_macro": [{"date": "2026-02-14", "unemployment_rate": 4.3, "cpi_yoy": 2.8286797395498997, "core_cpi_yoy": 2.9493378374616075, "pce_yoy": 2.772852363262901, "pmi": null, "wage_yoy": 3.7109375}, {"date": "2026-02-23", "unemployment_rate": 4.3, "cpi_yoy": 2.8286797395498997, "core_cpi_yoy": 2.9493378374616075, "pce_yoy": 2.901287416285925, "pmi": null, "wage_yoy": 3.7109375}, {"date": "2026-02-24", "unemployment_rate": 4.3, "cpi_yoy": 2.8286797395498997, "core_cpi_yoy": 2.9493378374616075, "pce_yoy": 2.901287416285925, "pmi": null, "wage_yoy": 3.7109375}, {"date": "2026-02-25", "unemployment_rate": 4.3, "cpi_yoy": 2.8286797395498997, "core_cpi_yoy": 2.9493378374616075, "pce_yoy": 2.901287416285925, "pmi": null, "wage_yoy": 3.7109375}, {"date": "2026-02-26", "unemployment_rate": 4.3, "cpi_yoy": 2.8286797395498997, "core_cpi_yoy": 2.9493378374616075, "pce_yoy": 2.901287416285925, "pmi": null, "wage_yoy": 3.7109375}, {"date": "2026-02-27", "unemployment_rate": 4.3, "cpi_yoy": 2.8286797395498997, "core_cpi_yoy": 2.9493378374616075, "pce_yoy": 2.901287416285925, "pmi": null, "wage_yoy": 3.7109375}], "quarterly_macro": [{"date": "2026-02-14", "real_gdp": 24026.834, "gdp_qoq_annualized": 4.4}, {"date": "2026-02-23", "real_gdp": 24111.83, "gdp_qoq_annualized": 1.4}, {"date": "2026-02-24", "real_gdp": 24111.83, "gdp_qoq_annualized": 1.4}, {"date": "2026-02-25", "real_gdp": 24111.83, "gdp_qoq_annualized": 1.4}, {"date": "2026-02-26", "real_gdp": 24111.83, "gdp_qoq_annualized": 1.4}, {"date": "2026-02-27", "real_gdp": 24111.83, "gdp_qoq_annualized": 1.4}], "committee_history": [{"market_date": "2026-02-07", "consensus": "Committee agrees on a neutral stance with selective monitoring.", "ok_count": 1, "caution_count": 1, "avoid_count": 1, "ok_text": "Keep watchlist tight and avoid overexposure.", "caution_text": "Keep position sizes moderate.", "avoid_text": "Avoid aggressive leverage."}, {"market_date": "2026-02-13", "consensus": "Committee agrees on a neutral stance with selective monitoring.", "ok_count": 1, "caution_count": 1, "avoid_count": 1, "ok_text": "Keep watchlist tight and avoid overexposure.", "caution_text": "Keep position sizes moderate.", "avoid_text": "Avoid aggressive leverage."}, {"market_date": "2026-02-14", "consensus": "Committee agrees on a neutral stance with selective monitoring.", "ok_count": 1, "caution_count": 1, "avoid_count": 1, "ok_text": "Keep watchlist tight and avoid overexposure.", "caution_text": "Keep position sizes moderate.", "avoid_text": "Avoid aggressive leverage."}, {"market_date": "2026-02-23", "consensus": "Committee agrees on a neutral stance with selective monitoring.", "ok_count": 1, "caution_count": 1, "avoid_count": 1, "ok_text": "Keep watchlist tight and avoid overexposure.", "caution_text": "Keep position sizes moderate.", "avoid_text": "Avoid aggressive leverage."}, {"market_date": "2026-02-24", "consensus": "Committee agrees on a neutral stance with selective monitoring.", "ok_count": 1, "caution_count": 1, "avoid_count": 1, "ok_text": "Keep watchlist tight and avoid overexposure.", "caution_text": "Keep position sizes moderate.", "avoid_text": "Avoid aggressive leverage."}, {"market_date": "2026-02-25", "consensus": "Committee agrees on a neutral stance with selective monitoring.", "ok_count": 1, "caution_count": 1, "avoid_count": 1, "ok_text": "Keep watchlist tight and avoid overexposure.", "caution_text": "Keep position sizes moderate.", "avoid_text": "Avoid aggressive leverage."}, {"market_date": "2026-02-26", "consensus": "Committee supports risk-on positioning with disciplined risk controls.", "ok_count": 1, "caution_count": 1, "avoid_count": 1, "ok_text": "Lean into confirmed momentum leaders.", "caution_text": "Size positions with volatility limits.", "avoid_text": "Avoid chasing overstretched breakouts."}, {"market_date": "2026-02-27", "consensus": "Committee maintains a neutral posture with selective positioning.", "ok_count": 1, "caution_count": 1, "avoid_count": 1, "ok_text": "Maintain balanced exposure.", "caution_text": "Keep risk limits tight.", "avoid_text": "Avoid aggressive leverage."}], "latest_stances": {"market_date": "2026-02-27", "stances": [{"agent_name": "macro", "regime_tag": "NEUTRAL", "confidence": "MED", "korean_comment": "ê±°ì‹œëŠ” ê· í˜•ì ì´ë©° ì„ íƒì  ëŒ€ì‘ì´ ì ì ˆí•©ë‹ˆë‹¤.", "core_claims": ["Macro tone is balanced.", "No major shocks.", "Stay selective."]}, {"agent_name": "flow", "regime_tag": "NEUTRAL", "confidence": "LOW", "korean_comment": "ìˆ˜ê¸‰ ë°ì´í„°ê°€ ì—†ì–´ ì¤‘ë¦½ì„ ìœ ì§€í•©ë‹ˆë‹¤.", "core_claims": ["Flow data unavailable.", "Use neutral stance."]}, {"agent_name": "sector", "regime_tag": "RISK_OFF", "confidence": "HIGH", "korean_comment": "ì™¸êµ­ì¸ ë§¤ë„ì„¸ì™€ ê¸€ë¡œë²Œ ê¸°ìˆ ì£¼ ì•½ì„¸ë¡œ ì‹œì¥ ê²½ê³„ê°ì´ ì»¤ì¡ŒìŠµë‹ˆë‹¤.", "core_claims": ["ì½”ìŠ¤í”¼ê°€ 1% í•˜ë½í•˜ë©° ì™¸êµ­ì¸ ëŒ€ê·œëª¨ ìˆœë§¤ë„ê°€ í™•ì¸ë¨.", "ì—”ë¹„ë””ì•„ ë“± ë¯¸êµ­ ê¸°ìˆ ì£¼ ì•½ì„¸ê°€ êµ­ë‚´ ì‹œì¥ì— ë¶€ì •ì  ì˜í–¥ì„ ì¤Œ.", "ë³€ë™ì„± í™•ëŒ€ì™€ ì™¸êµ­ì¸ ì´íƒˆë¡œ ë‹¨ê¸° ì¡°ì • ìœ„í—˜ì´ ë†’ì•„ì§."]}, {"agent_name": "risk", "regime_tag": "NEUTRAL", "confidence": "MED", "korean_comment": "ì‹œì¥ ë³€ë™ì„±ì´ ì»¤ì§€ê³  ìˆìœ¼ë‚˜ ê³¼ë„í•œ ê³µí¬ ì‹ í˜¸ëŠ” ì•„ë‹˜.", "core_claims": ["ì½”ìŠ¤í”¼ê°€ 1% í•˜ë½í•˜ë©° ë³€ë™ì„±ì´ í™•ëŒ€ë¨", "ì™¸êµ­ì¸ ëŒ€ê·œëª¨ ìˆœë§¤ë„ ë³´ë„ ë“± íˆ¬ìì‹¬ë¦¬ ìœ„ì¶• ì‹ í˜¸", "ë¯¸êµ­ ê¸°ìˆ ì£¼ ì•½ì„¸ì™€ ì—°ë™ëœ êµ­ë‚´ ì‹œì¥ ì•½ì„¸"]}, {"agent_name": "earnings", "regime_tag": "NEUTRAL", "confidence": "MED", "korean_comment": "ì‹¤ì  ì¶”ì •ì¹˜ ë³€í™”ëŠ” ì•„ì§ ëšœë ·í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.", "core_claims": ["ì‹¤ì  ëª¨ë©˜í…€ ë‘”í™” ì‹ í˜¸ê°€ ëšœë ·í•˜ì§€ ì•ŠìŒ", "ì™¸êµ­ì¸ ë§¤ë„ëŠ” ì¼ì‹œì  ë¦¬ë°¸ëŸ°ì‹± ì˜í–¥", "ì‹¤ì  ì¶”ì •ì¹˜ í•˜í–¥ ì¡°ì • ì‹ í˜¸ëŠ” ì•„ì§ ì œí•œì "]}, {"agent_name": "breadth", "regime_tag": "NEUTRAL", "confidence": "LOW", "korean_comment": "ë¸Œë ˆë“œìŠ¤ ì‹ í˜¸ê°€ í˜¼ì¬ë˜ì–´ ì¤‘ë¦½ ëŒ€ì‘ì´ í•©ë¦¬ì ì…ë‹ˆë‹¤.", "core_claims": ["ì¶”ì„¸ í™•ì‚°ê³¼ ì—­ì¶”ì„¸ ì‹ í˜¸ê°€ ê³µì¡´í•©ë‹ˆë‹¤.", "ê¸°ìˆ ì  ìš°ìœ„ê°€ ëª…í™•í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.", "ë°©í–¥ í™•ì • ì „ê¹Œì§€ ê· í˜• ë¹„ì¤‘ì´ ì ì ˆí•©ë‹ˆë‹¤."]}, {"agent_name": "liquidity", "regime_tag": "RISK_OFF", "confidence": "HIGH", "korean_comment": "ìœ ë™ì„± ì•…í™”ì™€ ì™¸êµ­ì¸ ì´íƒˆë¡œ ë³´ìˆ˜ì  ëŒ€ì‘ì´ í•„ìš”í•©ë‹ˆë‹¤.", "core_claims": ["ì½”ìŠ¤í”¼ 1% í•˜ë½ê³¼ ì™¸êµ­ì¸ ëŒ€ê·œëª¨ ìˆœë§¤ë„ëŠ” ìœ ë™ì„± ê²½ìƒ‰ ì‹ í˜¸ì…ë‹ˆë‹¤.", "USD/KRW 1429, ë³€ë™ì„±(VIX) 18.6ìœ¼ë¡œ í™˜ìœ¨Â·ë³€ë™ì„± ëª¨ë‘ ë³´ìˆ˜ì ì…ë‹ˆë‹¤.", "ì •ì±… ë¯¼ê° ìœ ë™ì„± í™˜ê²½ì€ ìœ„í—˜íšŒí”¼(RISK_OFF)ë¡œ ì „í™˜ ì¤‘ì…ë‹ˆë‹¤."]}]}, "latest_committee": {"market_date": "2026-02-27", "consensus": "Committee maintains a neutral posture with selective positioning.", "key_points": ["Majority regime tag: NEUTRAL.", "Shared evidence focus: snapshot.news_headlines."], "ops_guidance": [{"level": "OK", "text": "Maintain balanced exposure."}, {"level": "CAUTION", "text": "Keep risk limits tight."}, {"level": "AVOID", "text": "Avoid aggressive leverage."}]}};

const LABEL_BY_LEVEL = {
  OK: 'ìœ ì§€',
  CAUTION: 'ì£¼ì˜',
  AVOID: 'íšŒí”¼',
};

const REGIME_LABELS = {
  RISK_ON: 'RISK_ON (ë¹„ì¤‘ í™•ëŒ€)',
  RISK_OFF: 'RISK_OFF (ë¹„ì¤‘ ì¶•ì†Œ)',
  NEUTRAL: 'NEUTRAL (ì¤‘ë¦½ ë¹„ì¤‘)',
};

const CHAIR_TEXT_MAP = {
  'Committee agrees on a neutral stance with selective monitoring.': 'ìœ„ì›íšŒëŠ” ì„ ë³„ì  ëª¨ë‹ˆí„°ë§ í•˜ì— ì¤‘ë¦½ ìŠ¤íƒ ìŠ¤ë¥¼ ìœ ì§€í•©ë‹ˆë‹¤.',
  'Committee maintains a neutral posture with selective positioning.': 'ìœ„ì›íšŒëŠ” ì„ ë³„ì  í¬ì§€ì…”ë‹ì„ ì „ì œë¡œ ì¤‘ë¦½ì  ì…ì¥ì„ ìœ ì§€í•©ë‹ˆë‹¤.',
  'Committee adopts a defensive posture and reduces risk exposure.': 'ìœ„ì›íšŒëŠ” ë°©ì–´ì  ì…ì¥ì„ ì±„íƒí•˜ê³  ìœ„í—˜ ë…¸ì¶œì„ ì¶•ì†Œí•©ë‹ˆë‹¤.',
  'Committee supports risk-on positioning with disciplined risk controls.': 'ìœ„ì›íšŒëŠ” ì—„ê²©í•œ ë¦¬ìŠ¤í¬ í†µì œë¥¼ ì „ì œë¡œ ìœ„í—˜ìì‚° ë¹„ì¤‘ í™•ëŒ€ë¥¼ ì§€ì§€í•©ë‹ˆë‹¤.',
  'Majority regime tag: RISK_ON.': 'ë‹¤ìˆ˜ êµ­ë©´ íƒœê·¸: RISK_ON (ë¹„ì¤‘ í™•ëŒ€).',
  'Majority regime tag: RISK_OFF.': 'ë‹¤ìˆ˜ êµ­ë©´ íƒœê·¸: RISK_OFF (ë¹„ì¤‘ ì¶•ì†Œ).',
  'Majority regime tag: NEUTRAL.': 'ë‹¤ìˆ˜ êµ­ë©´ íƒœê·¸: NEUTRAL (ì¤‘ë¦½ ë¹„ì¤‘).',
  'Shared evidence focus: snapshot.news_headlines.': 'ê³µí†µ ê·¼ê±°: snapshot.news_headlines.',
  'Shared evidence focus: snapshot.market_summary.note.': 'ê³µí†µ ê·¼ê±°: snapshot.market_summary.note.',
  'Maintain balanced exposure.': 'ê· í˜• ë¹„ì¤‘ì„ ìœ ì§€í•©ë‹ˆë‹¤.',
  'Keep risk limits tight.': 'ë¦¬ìŠ¤í¬ í•œë„ë¥¼ ì—„ê²©íˆ ìœ ì§€í•©ë‹ˆë‹¤.',
  'Avoid aggressive leverage.': 'ê³¼ë„í•œ ë ˆë²„ë¦¬ì§€ëŠ” í”¼í•©ë‹ˆë‹¤.',
  'Lean into confirmed momentum leaders.': 'ê²€ì¦ëœ ëª¨ë©˜í…€ ì£¼ë„ì£¼ ì¤‘ì‹¬ìœ¼ë¡œ ëŒ€ì‘í•©ë‹ˆë‹¤.',
  'Size positions with volatility limits.': 'ë³€ë™ì„± í•œë„ ë‚´ì—ì„œ í¬ì§€ì…˜ ê·œëª¨ë¥¼ ì¡°ì ˆí•©ë‹ˆë‹¤.',
  'Avoid chasing overstretched breakouts.': 'ê³¼ì—´ëœ ëŒíŒŒ êµ¬ê°„ ì¶”ê²© ë§¤ìˆ˜ëŠ” í”¼í•©ë‹ˆë‹¤.',
  'Keep exposure focused on resilience.': 'ë°©ì–´ë ¥ì´ ë†’ì€ ìì‚° ì¤‘ì‹¬ìœ¼ë¡œ ë…¸ì¶œì„ ìœ ì§€í•©ë‹ˆë‹¤.',
  'Favor defensive positioning.': 'ë°©ì–´ì ì¸ í¬ì§€ì…”ë‹ì„ ìš°ì„ í•©ë‹ˆë‹¤.',
  'Avoid high-beta risk assets.': 'ê³ ë² íƒ€ ìœ„í—˜ìì‚°ì€ í”¼í•©ë‹ˆë‹¤.',
};

function formatRegimeTag(tag) {
  return REGIME_LABELS[tag] || tag || '-';
}

function toKoreanChairText(text) {
  return CHAIR_TEXT_MAP[text] || text || '-';
}

function formatGuidanceLevel(level) {
  return LABEL_BY_LEVEL[level] ? `${level} Â· ${LABEL_BY_LEVEL[level]}` : (level || '-');
}

function latest(rows, key) {
  if (!rows.length) return '-';
  const value = rows[rows.length - 1][key];
  return value ?? '-';
}

function coverage(rows, key) {
  if (!rows.length) return '-';
  const valid = rows.filter(r => r[key] !== null && r[key] !== undefined).length;
  return `${Math.round((valid / rows.length) * 100)}%`;
}

function formatMetric(value) {
  if (value === null || value === undefined || value === '') return '-';
  if (typeof value === 'number' && Number.isFinite(value)) return value.toFixed(2);
  return value;
}

const cards = [
  { label: 'ìµœê·¼ KOSPI(%)', value: formatMetric(latest(data.market_daily, 'kospi_pct')) },
  { label: 'ìµœê·¼ NASDAQ(%)', value: formatMetric(latest(data.market_daily, 'nasdaq_pct')) },
  { label: 'ìµœê·¼ VIX', value: formatMetric(latest(data.daily_macro, 'vix')) },
  { label: 'ìµœê·¼ USD/KRW', value: formatMetric(latest(data.daily_macro, 'usdkrw')) },
  { label: 'ìµœê·¼ VIX ê¸°ê°„ìŠ¤í”„ë ˆë“œ', value: formatMetric(latest(data.daily_macro, 'vix_term_spread')) },
  { label: 'ìµœê·¼ HY OAS', value: formatMetric(latest(data.daily_macro, 'hy_oas')) },
  { label: 'VIX ê¸°ê°„ìŠ¤í”„ë ˆë“œ ì ì¬ìœ¨', value: coverage(data.daily_macro, 'vix_term_spread') },
  { label: 'HY/IG OAS ì ì¬ìœ¨', value: `${coverage(data.daily_macro, 'hy_oas')} / ${coverage(data.daily_macro, 'ig_oas')}` },
  { label: 'ëˆ„ì  íšŒì˜ì¼', value: data.committee_history.length },
];

const cardWrap = document.getElementById('summary-cards');
cardWrap.innerHTML = cards.map(c => `<div class="card"><div class="label">${c.label}</div><div class="value">${c.value}</div></div>`).join('');

const marketLabels = data.market_daily.map(r => r.date);
new Chart(document.getElementById('marketChart'), {
  type: 'line',
  data: { labels: marketLabels, datasets: [
    { label:'KOSPI', data:data.market_daily.map(r=>r.kospi_pct), borderColor:'#22d3ee' },
    { label:'KOSDAQ', data:data.market_daily.map(r=>r.kosdaq_pct), borderColor:'#f97316' },
    { label:'S&P500', data:data.market_daily.map(r=>r.sp500_pct), borderColor:'#a3e635' },
  ]},
});

new Chart(document.getElementById('macroChart'), {
  type:'line',
  data: { labels:data.daily_macro.map(r=>r.date), datasets:[
    { label:'VIX', data:data.daily_macro.map(r=>r.vix), borderColor:'#f43f5e', yAxisID:'y' },
    { label:'USD/KRW', data:data.daily_macro.map(r=>r.usdkrw), borderColor:'#38bdf8', yAxisID:'y1' }
  ]},
  options: { scales: { y: { position:'left' }, y1: { position:'right', grid: { drawOnChartArea:false } } } }
});

new Chart(document.getElementById('flowChart'), {
  type:'bar',
  data: { labels:data.market_flow_daily.map(r=>r.date), datasets:[
    { label:'Foreign Net', data:data.market_flow_daily.map(r=>r.foreign_net), backgroundColor:'#c084fc' }
  ]}
});



const chair = data.latest_committee || {};
const chairDate = document.getElementById('chairDate');
const chairConsensus = document.getElementById('chairConsensus');
const chairKeyPoints = document.getElementById('chairKeyPoints');
const chairGuidance = document.getElementById('chairGuidance');

chairDate.textContent = chair.market_date ? `(${chair.market_date})` : '';
chairConsensus.textContent = toKoreanChairText(chair.consensus);
chairKeyPoints.innerHTML = (chair.key_points || []).map(point => `<li>${toKoreanChairText(point)}</li>`).join('') || '<li>-</li>';
chairGuidance.innerHTML = (chair.ops_guidance || [])
  .map(item => `<li>[${formatGuidanceLevel(item.level)}] ${toKoreanChairText(item.text)}</li>`)
  .join('') || '<li>-</li>';

const table = document.getElementById('committeeTable');
table.innerHTML = data.committee_history.slice().reverse().map(r => `
  <tr>
    <td>${r.market_date}</td>
    <td>${toKoreanChairText(r.consensus)}</td>
    <td>${toKoreanChairText(r.ok_text) || '-'}</td>
    <td>${toKoreanChairText(r.caution_text) || '-'}</td>
    <td>${toKoreanChairText(r.avoid_text) || '-'}</td>
  </tr>
`).join('');

const guidanceHistoryTable = document.getElementById('guidanceHistoryTable');
guidanceHistoryTable.innerHTML = data.committee_history.slice().reverse().slice(0, 8).map(r => `
  <tr>
    <td>${r.market_date}</td>
    <td>${toKoreanChairText(r.ok_text) || '-'}</td>
    <td>${toKoreanChairText(r.caution_text) || '-'}</td>
    <td>${toKoreanChairText(r.avoid_text) || '-'}</td>
  </tr>
`).join('');

const stanceDate = document.getElementById('stanceDate');
const stanceTable = document.getElementById('stanceTable');
stanceDate.textContent = data.latest_stances.market_date ? `(${data.latest_stances.market_date})` : '';
stanceTable.innerHTML = (data.latest_stances.stances || []).map(s => `
  <tr>
    <td>${s.agent_name}</td>
    <td>${formatRegimeTag(s.regime_tag)}</td>
    <td>${formatMetric(s.confidence)}</td>
    <td>${s.korean_comment || '-'}</td>
    <td><ul>${(s.core_claims || []).map(claim => `<li>${claim}</li>`).join('')}</ul></td>
  </tr>
`).join('');
</script>
</body>
</html>
